{% extends 'base.html' %}
{% block title %}Courses{% endblock %}
{% block body %}
{% load static %}
    <script>
        var requireJS = [];
        loadJS(requireJS, "{% static 'dashboard/views/charts.js'%}");
    </script>
    <script>
        var search_val = "";                   
        function loadResults(event){
            
            page = document.getElementById(event.target.id).innerHTML;
            url = "/dashboard/student_courses/?page="+page;
            if(search_val != ""){
                url += "&keyword="+search_val;
            }
            $.ajax({        
                type: "GET",
                url: url,
                success: function(data) {
                    $('#courses_results').html(data);
                    document.getElementById(event.target.id).parentElement.classList.add("disabled")
                    document.getElementById(event.target.id).classList.add("active")
                },
        
                error: function(response, error) {
                    alert(response.responseText);  
                }
            });
        }
        function searchResults(e){
            search_val = $("#search_input").val();
            
            $.ajax({        
                type: "GET",
                url: "/dashboard/student_courses/?keyword="+search_val,
                success: function(data) {
                    $('#courses_results').html(data);
                },

                error: function (response, error) {
                    alert(response.responseText);
                }
            });
    }
    $(document).ready(function(){
        var input_val;
        $("#search_btn").click(function(e){
            input_val = $("#search_input").val();
            if(input_val !== search_val){
                searchResults();
            }
        });
        $("#search_input").keypress(function(e){
            input_val = $("#search_input").val();
            if(input_val !== search_val){
                var key_pressed = e.which;
                if(key_pressed == 13){
                    searchResults();
                }
            }
        });
    });
    </script>
    <input type="hidden" id="myVar" name="variable" readonly value="{{ student_predictions.courses }}">

    <input type="hidden" id="total" name="variable" readonly value="{{ student_courses_num_pages }}">
    <main class="animated fadeIn row">

        <div class="card" style="margin-top: 10px">
            <div class="card-header">
                <h3 class="card-title mb-0">Courses Performance</h3>
            </div>
            <div class="card-body">
                <div class="row">

                    <div class="input-group-btn col-md-6">
                        <button type="button" class="btn btn-light dropdown-toggle"
                                data-toggle="dropdown">Year
                            <span class="caret"></span>
                        </button>
                        <div class="dropdown-menu">
                            {% for year in years %}
                                <a class="dropdown-item" href="#">{{ year.name }}</a>
                            {% endfor %}
                            
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="btn-toolbar float-right" role="toolbar"
                             aria-label="Toolbar with button groups">
                            <div class="btn-group mr-3" data-toggle="buttons"
                                 aria-label="First group">
                                {% for term in terms %}
                                    {% if forloop.counter == 1 %}
                                        <label class="btn btn-outline-secondary active">
                                    {% else %}
                                        <label class="btn btn-outline-secondary">
                                    {% endif %}
                                <input type="radio" name="options" id="option" +"{{ forloop.counter }}"
                                > {{ term.name }}
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-wrapper" style="height: 70vh;width: 80vw;">
                    <canvas id="canvas-1" class="chart"
                            style="height: inherit;"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-12">
            <div class="card" style="margin-top: 10px">
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-8 col-sm-12">
                            <h3 class="card-title mb-0">Courses</h3>
                        </div>
                        <div class="input-group col-md-4 col-sm-12">
                            <input type="text" id="search_input"
                                   name="input1-group2"
                                   class="form-control" placeholder="Course Name">
                            <span class=" input-group-btn ">
                        <button type="button" class="btn btn-primary " id ="search_btn"><i
                                class="fa fa-search"></i></button>
                      </span>

                        </div>
                    </div>
                </div>
                <div class="card-body" id="courses_results">
                    {% include "./courses_pagination.html" %}
                </div>
            </div>
        </div>
    </main>

{% endblock %}